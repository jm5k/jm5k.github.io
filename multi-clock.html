<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>24-Hour Linear Clock | Multi-Timezone</title>
<meta name="description" content="Multi-timezone 24-hour linear clock by jm5k — add world clocks and see each day’s progress at a glance." />
<meta name="keywords" content="linear clock, multi timezone, jm5k, minimalist clock, 24-hour timeline, time visualization" />
<meta name="author" content="jm5k" />
<link rel="icon" href="https://jm5k.github.io/profile.png" type="image/png" />

<style>
  :root {
    --fg:#ccc;
    --muted:#888;
    --accent:#0ff;
    --rail:#222;
    --marker:#0ff;
    --tick:#333;
    --yellow:#cc9; /* toned down */
  }
  * { box-sizing:border-box; }
  html, body { height:100%; }
  body {
    background:#000;
    color:var(--fg);
    font-family:monospace;
    margin:0;
    padding:32px 16px 64px;
  }
  a, a:visited, a:hover, a:active { color:var(--accent); }

  .wrap { max-width:960px; margin:0 auto; }

  h1 { margin:0 0 10px; font-weight:600; font-size:1.25rem; color:var(--yellow); }
  p.sub { margin:0 0 18px; color:var(--muted); }

  /* Controls */
  .controls {
    display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin:16px 0 20px;
  }
  .controls select, .controls button, .controls input[type="text"] {
    background:#111; color:var(--fg); border:1px solid #222; padding:8px 10px;
    font-family:inherit; border-radius:6px;
  }
  .controls button { cursor:pointer; }
  .controls .always-links a { margin-right:12px; text-decoration:none; }

  /* Thin nav line (your preferred style) */
  hr.nav { border:none; border-top:1px solid rgba(255,255,255,0.1); margin:24px 0; }

  /* Clock block */
  .clock {
    border:1px solid #111; border-radius:10px; padding:14px 14px 18px; margin:18px 0;
    background:#070707; box-shadow:0 0 0 1px #0a0a0a inset;
  }
  .clock .head { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; gap:10px; }
  .clock .title { color:var(--accent); font-weight:600; display:flex; align-items:center; gap:8px; }
  .clock .title small { color:var(--muted); font-weight:400; }
  .clock .now { color:var(--accent); }
  .clock .pct { color:var(--yellow); }
  .clock .subline { color:var(--muted); font-size:0.9rem; display:flex; align-items:center; gap:10px; }

  .remove-btn {
    background:#111; color:#999; border:1px solid #222; padding:2px 6px; border-radius:6px; cursor:pointer;
  }
  .remove-btn:hover { color:#fff; border-color:#333; }

  /* Linear rail */
  .rail {
    position:relative; height:8px; background:var(--rail); border-radius:999px; margin:12px 0 6px;
    outline:1px solid #0a0a0a;
  }
  .fill {
    position:absolute; left:0; top:0; bottom:0; width:0%;
    background:linear-gradient(to right, rgba(0,255,255,0.25), rgba(0,255,255,0.9));
    border-radius:999px;
  }
  .marker {
    position:absolute; top:50%; transform:translate(-50%,-50%); height:16px; width:2px; background:var(--marker);
    box-shadow:0 0 6px rgba(0,255,255,0.75);
  }
  .ticks {
    position:relative; display:flex; justify-content:space-between; font-size:0.8rem;
  }
  .ticks span { color:#555; }

  #extraClocks { margin-top:10px; }
</style>
</head>
<body>
  <div class="wrap">
    <h1>24-Hour Linear Clock — Multi-Timezone</h1>
    <p class="sub">Live progress through the day. Add world clocks below. Middle-click a clock to remove, or use its ✕ button.</p>

    <div class="controls">
      <!-- Always-cyan links -->
      <div class="always-links">
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
      </div>

      <!-- Add-timezone controls -->
      <select id="tzSelect" title="Choose a timezone"></select>
      <button id="addBtn" aria-label="Add timezone clock">Add</button>

      <!-- Optional label override -->
      <input id="labelInput" type="text" placeholder="Optional label (e.g., London HQ)" />
    </div>

    <hr class="nav" />

    <!-- Default/local clock -->
    <section id="defaultClock" class="clock" data-tz="local">
      <div class="head">
        <div class="title">Local Time <small>(system)</small></div>
        <div class="now" id="currentTimeTop">--:--:--</div>
      </div>
      <div class="rail">
        <div class="fill" id="fill-default"></div>
        <div class="marker" id="marker-default" style="left:0%;"></div>
      </div>
      <div class="ticks">
        <span>00:00</span><span>06:00</span><span>12:00</span><span>18:00</span><span>24:00</span>
      </div>
      <div class="subline">
        <span class="pct" id="pct-default">0.00%</span> of day elapsed
      </div>
    </section>

    <!-- Extra clocks appear here -->
    <div id="extraClocks"></div>
  </div>

<script>
/* ===================== Utilities ===================== */
const pad = (n)=> String(n).padStart(2,'0');

function getNowInTZ(tz) {
  if (tz === 'local') return new Date();
  const parts = new Intl.DateTimeFormat('en-CA', {
    timeZone: tz, year:'numeric', month:'2-digit', day:'2-digit',
    hour:'2-digit', minute:'2-digit', second:'2-digit', hour12:false
  }).formatToParts(new Date());
  const map = Object.fromEntries(parts.map(p => [p.type, p.value]));
  // Construct a local Date from components — good enough for display/progress math
  return new Date(`${map.year}-${map.month}-${map.day}T${map.hour}:${map.minute}:${map.second}`);
}

function dayPercent(dateObj) {
  const h = dateObj.getHours(), m = dateObj.getMinutes(), s = dateObj.getSeconds();
  const secs = h*3600 + m*60 + s;
  return (secs / 86400) * 100;
}

function fmtTime(dateObj) {
  return `${pad(dateObj.getHours())}:${pad(dateObj.getMinutes())}:${pad(dateObj.getSeconds())}`;
}

function tick(clockEl, tz) {
  const now = getNowInTZ(tz);
  const pct = dayPercent(now);
  const pctStr = pct.toFixed(2);

  const fill = clockEl.querySelector('.fill');
  const marker = clockEl.querySelector('.marker');
  const pctEl = clockEl.querySelector('.pct');
  const nowEl = clockEl.querySelector('.now');

  if (fill)   fill.style.width = pct + '%';
  if (marker) marker.style.left = pct + '%';
  if (pctEl)  pctEl.textContent = `${pctStr}%`;
  if (nowEl)  nowEl.textContent = fmtTime(now);
}

/* ===================== Default clock loop ===================== */
const defaultClockEl = document.getElementById('defaultClock');
function loopDefault() { tick(defaultClockEl, 'local'); }
loopDefault();
setInterval(loopDefault, 1000);

/* ===================== Dynamic clocks ===================== */
const extraClocks = document.getElementById('extraClocks');
const addBtn = document.getElementById('addBtn');
const tzSelect = document.getElementById('tzSelect');
const labelInput = document.getElementById('labelInput');

// Keep active TZs to prevent duplicates (allow label changes)
const activeZones = new Set();

function idSafeFrom(text) {
  return text.replace(/[^a-z0-9]/gi,'-').toLowerCase();
}

function createClock(tz, label) {
  if (activeZones.has(tz)) return null;
  activeZones.add(tz);

  const idSafe = idSafeFrom(tz);
  const el = document.createElement('section');
  el.className = 'clock';
  el.dataset.tz = tz;
  el.id = `clock-${idSafe}`;

  const titleLabel = label ? `${label} · ${tz}` : tz;

  el.innerHTML = `
    <div class="head">
      <div class="title">${titleLabel}</div>
      <div style="display:flex; align-items:center; gap:8px;">
        <div class="now">--:--:--</div>
        <button class="remove-btn" title="Remove this clock" aria-label="Remove">✕</button>
      </div>
    </div>
    <div class="rail">
      <div class="fill"></div>
      <div class="marker" style="left:0%;"></div>
    </div>
    <div class="ticks">
      <span>00:00</span><span>06:00</span><span>12:00</span><span>18:00</span><span>24:00</span>
    </div>
    <div class="subline"><span class="pct">0.00%</span> of day elapsed</div>
  `;

  // Remove on middle-click (keeps UI minimal)
  el.addEventListener('auxclick', (e) => {
    if (e.button === 1) { removeClock(tz); }
  });

  // Remove on ✕ click
  el.querySelector('.remove-btn').addEventListener('click', () => removeClock(tz));

  extraClocks.appendChild(el);
  return el;
}

function removeClock(tz) {
  const idSafe = idSafeFrom(tz);
  const el = document.getElementById(`clock-${idSafe}`);
  if (el && el._interval) clearInterval(el._interval);
  if (el && el.parentNode) el.parentNode.removeChild(el);
  activeZones.delete(tz);
}

addBtn.addEventListener('click', () => {
  const tz = tzSelect.value.trim();
  const label = labelInput.value.trim();
  if (!tz) return;

  try {
    new Intl.DateTimeFormat('en-US', { timeZone: tz });
  } catch {
    alert('Invalid timezone.');
    return;
  }
  const el = createClock(tz, label);
  if (!el) return;

  function loop() { tick(el, tz); }
  loop();
  el._interval = setInterval(loop, 1000);
  labelInput.value = '';
});

/* Allow Enter on select or label to add quickly */
tzSelect.addEventListener('keydown', (e) => { if (e.key === 'Enter') addBtn.click(); });
labelInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') addBtn.click(); });

/* ===================== Populate full IANA tz list ===================== */
(function populateTimezones() {
  let zones = [];
  if (typeof Intl.supportedValuesOf === 'function') {
    try { zones = Intl.supportedValuesOf('timeZone'); } catch {}
  }
  if (!zones || zones.length === 0) {
    zones = [
      "Africa/Abidjan","Africa/Accra","Africa/Cairo","Africa/Johannesburg","Africa/Lagos","Africa/Nairobi",
      "America/Adak","America/Anchorage","America/Araguaina","America/Argentina/Buenos_Aires",
      "America/Asuncion","America/Bahia","America/Bahia_Banderas","America/Barbados","America/Belem",
      "America/Belize","America/Boa_Vista","America/Bogota","America/Boise","America/Cambridge_Bay",
      "America/Campo_Grande","America/Cancun","America/Caracas","America/Cayenne","America/Chicago",
      "America/Chihuahua","America/Costa_Rica","America/Cuiaba","America/Curacao","America/Danmarkshavn",
      "America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Edmonton",
      "America/El_Salvador","America/Fort_Nelson","America/Fortaleza","America/Glace_Bay","America/Goose_Bay",
      "America/Grand_Turk","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax",
      "America/Havana","America/Hermosillo","America/Indiana/Indianapolis","America/Indiana/Knox",
      "America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City",
      "America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Inuvik",
      "America/Iqaluit","America/Jamaica","America/Juneau","America/Kentucky/Louisville",
      "America/Kentucky/Monticello","America/La_Paz","America/Lima","America/Los_Angeles","America/Maceio",
      "America/Managua","America/Manaus","America/Martinique","America/Matamoros","America/Mazatlan",
      "America/Merida","America/Metlakatla","America/Mexico_City","America/Miquelon","America/Moncton",
      "America/Monterrey","America/Montevideo","America/New_York","America/Nome","America/Noronha",
      "America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem",
      "America/Nuuk","America/Ojinaga","America/Panama","America/Paramaribo","America/Phoenix",
      "America/Port-au-Prince","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico",
      "America/Punta_Arenas","America/Recife","America/Regina","America/Resolute","America/Rio_Branco",
      "America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund",
      "America/Sitka","America/St_Johns","America/Swift_Current","America/Tegucigalpa","America/Thule",
      "America/Tijuana","America/Toronto","America/Vancouver","America/Whitehorse","America/Winnipeg",
      "America/Yakutat","Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Macquarie",
      "Antarctica/Mawson","Antarctica/Palmer","Antarctica/Rothera","Antarctica/Syowa","Antarctica/Troll",
      "Antarctica/Vostok","Arctic/Longyearbyen","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau",
      "Asia/Aqtobe","Asia/Ashgabat","Asia/Atyrau","Asia/Baghdad","Asia/Baku","Asia/Bangkok","Asia/Barnaul",
      "Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Chita","Asia/Choibalsan","Asia/Colombo","Asia/Damascus",
      "Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Famagusta","Asia/Gaza","Asia/Hebron",
      "Asia/Ho_Chi_Minh","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem",
      "Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Kathmandu","Asia/Khandyga","Asia/Kolkata","Asia/Krasnoyarsk",
      "Asia/Kuching","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Nicosia","Asia/Novokuznetsk",
      "Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qostanay",
      "Asia/Qyzylorda","Asia/Riyadh","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore",
      "Asia/Srednekolymsk","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Thimphu",
      "Asia/Tokyo","Asia/Tomsk","Asia/Ulaanbaatar","Asia/Urumqi","Asia/Ust-Nera","Asia/Vladivostok",
      "Asia/Yakutsk","Asia/Yangon","Asia/Yekaterinburg","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda",
      "Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faroe","Atlantic/Madeira","Atlantic/Reykjavik",
      "Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Darwin","Australia/Eucla",
      "Australia/Hobart","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/Perth",
      "Australia/Sydney","Europe/Amsterdam","Europe/Andorra","Europe/Athens","Europe/Belgrade","Europe/Berlin",
      "Europe/Bratislava","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Chisinau","Europe/Copenhagen",
      "Europe/Dublin","Europe/Gibraltar","Europe/Guernsey","Europe/Helsinki","Europe/Isle_of_Man","Europe/Istanbul",
      "Europe/Jersey","Europe/Kaliningrad","Europe/Kiev","Europe/Kirov","Europe/Lisbon","Europe/Ljubljana",
      "Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Mariehamn","Europe/Minsk",
      "Europe/Monaco","Europe/Moscow","Europe/Oslo","Europe/Paris","Europe/Podgorica","Europe/Prague","Europe/Riga",
      "Europe/Rome","Europe/Samara","Europe/San_Marino","Europe/Sarajevo","Europe/Skopje","Europe/Sofia","Europe/Stockholm",
      "Europe/Tallinn","Europe/Tirane","Europe/Uzhgorod","Europe/Vaduz","Europe/Vatican","Europe/Vienna","Europe/Vilnius",
      "Europe/Volgograd","Europe/Warsaw","Europe/Zagreb","Europe/Zaporozhye","Europe/Zurich","Indian/Chagos",
      "Indian/Christmas","Indian/Cocos","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius",
      "Indian/Reunion","Pacific/Apia","Pacific/Auckland","Pacific/Bougainville","Pacific/Chatham","Pacific/Chuuk",
      "Pacific/Easter","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Funafuti",
      "Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Kanton",
      "Pacific/Kiritimati","Pacific/Kosrae","Pacific/Kwajalein","Pacific/Majuro","Pacific/Marquesas","Pacific/Midway",
      "Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau",
      "Pacific/Pitcairn","Pacific/Pohnpei","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Saipan","Pacific/Tahiti",
      "Pacific/Tarawa","Pacific/Tongatapu","Pacific/Wake","UTC"
    ];
  }

  // Favorites at top
  const favorites = [
    "America/New_York","America/Chicago","America/Denver","America/Los_Angeles",
    "UTC","Europe/London","Europe/Paris","Asia/Tokyo","Asia/Kolkata","Australia/Sydney"
  ];
  const setFav = new Set(favorites);
  const sorted = [...zones].sort((a,b)=>a.toLowerCase().localeCompare(b.toLowerCase()));
  const finalList = [...favorites, ...sorted.filter(z=>!setFav.has(z))];

  const frag = document.createDocumentFragment();
  finalList.forEach(z => {
    const opt = document.createElement('option');
    opt.value = z;
    opt.textContent = z;
    frag.appendChild(opt);
  });
  tzSelect.appendChild(frag);

  // Preselect system tz if available
  try {
    const sys = Intl.DateTimeFormat().resolvedOptions().timeZone;
    if (sys && finalList.includes(sys)) tzSelect.value = sys;
  } catch {}
})();

</script>
<footer style="text-align:center; color:#666; font-size:0.85rem; margin-top:40px;">
  © 2025 jm5k
</footer>

</body>
</html>
